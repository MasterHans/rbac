# RBAC в Yii2

## Примечание
Аутентификация — процедура проверки подлинности, например проверка подлинности пользователя путем сравнения введенного
им пароля с паролем, сохраненным в базе данных. 
Авторизация — предоставление определенному лицу или группе лиц прав
на выполнение определенных действий.

## Фильтры контроля доступа (ACF)
Подключаются через поведение. ACF проверяет набор правил доступа, чтобы убедиться, что пользователь имеет доступ 
к запрошенному действию.

    [
        'allow' => true,
        'actions' => ['login', 'signup'],
        'roles' => ['?'],
    ],
    [
        'allow' => true,
        'actions' => ['logout'],
        'roles' => ['@'],
    ],

? - гость
@ - авторизованный пользователь
Использование других имён ролей будет приводить к вызову метода yii\web\User::can(), который требует включения RBAC
(будет описано дальше). Если свойство пустое или не задано, то правило применяется ко всем ролям.
actions - список действий

 - Разрешить всем гостям (ещё не прошедшим авторизацию) доступ к действиям login и signup.
   Опция roles содержит знак вопроса ?, это специальный токен обозначающий "гостя".
 - Разрешить аутентифицированным пользователям доступ к действию logout. Символ @ — это другой специальный токен,
   обозначающий аутентифицированного пользователя.

ACF привязываем к пользователю

    public function behaviors()
    {
        $userName = !empty(Yii::$app->user->getId()) ? User::findIdentity(Yii::$app->user->getId())->username : "<Not logged in>";
        return [
            'access' => [
                'class' => AccessControl::className(),
                'denyCallback' => function ($rule, $action) {
                    throw new \yii\web\NotFoundHttpException("Only registered admin user can work with admin panel! Please log in as admin!");
                },
                'rules' => [
                    [
                        'allow' => true,
                        'matchCallback' => function ($rule, $action) use ($userName) {
                            return $userName === 'admin';
                        }
                    ]
                ]
            ]
        ];
    }


only - указывает, что фильтр ACF нужно применять только к действиям login, logout и signup

## Role Based Access Control

Управление доступом на основе ролей (RBAC) обеспечивает простой, но мощный централизованный контроль доступа.
Пожалуйста, обратитесь к Wikipedia для получения информации о сравнении RBAC с другими, более традиционными, 
системами контроля доступа.

Yii реализует общую иерархическую RBAC, следуя NIST RBAC model. Обеспечивается функциональность RBAC через компонент
приложения authManager.

Использование RBAC состоит из двух частей. Первая часть — это создание RBAC данных авторизации, и вторая часть — 
это использование данных авторизации для проверки доступа в том месте, где это нужно.


# Настройка RBAC Manager



